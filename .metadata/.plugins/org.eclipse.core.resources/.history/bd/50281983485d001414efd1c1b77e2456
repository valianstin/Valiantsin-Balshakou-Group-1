package com.epam.task.multithreading;


import java.util.Date;

import org.apache.log4j.Logger;

public class MessageThread implements Runnable {
	int time;

	public MessageThread(int time) {
		super();
		this.time = (time-1)*1000;
	}

	@Override
	public void run() {
		// TODO Auto-generated method stub
		Logger logger = Logger.getLogger(Runner.class);
		Date lastMessageTime=new Date();
		Date currentTime=lastMessageTime;
		try {
			while (true) {
				
				while (currentTime.getTime()-lastMessageTime.getTime()<time){
					
					//logger.info("Message from MessageThread."+(currentTime.getTime()-lastMessageTime.getTime())+" milliseconds since last message");
					synchronized (Runner.locker) {
						Runner.locker.wait();
					}
					currentTime=new Date();
				}		
				
				logger.info("Message from MessageThread."+(currentTime.getTime()-lastMessageTime.getTime())+" milliseconds since last message");
				lastMessageTime=new Date();
				// System.out.println(time);
				Thread.currentThread().sleep(1000);
				time++;
			}
		} catch (InterruptedException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
	}

}
